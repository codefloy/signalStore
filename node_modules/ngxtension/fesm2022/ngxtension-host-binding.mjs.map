{"version":3,"file":"ngxtension-host-binding.mjs","sources":["../../../../libs/ngxtension/host-binding/src/host-binding.ts","../../../../libs/ngxtension/host-binding/src/ngxtension-host-binding.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/ban-types */\nimport {\n\teffect,\n\tElementRef,\n\tHostBinding,\n\tinject,\n\tInjector,\n\tRenderer2,\n\tRendererStyleFlags2,\n\trunInInjectionContext,\n\ttype Signal,\n\ttype WritableSignal,\n} from '@angular/core';\nimport { assertInjector } from 'ngxtension/assert-injector';\n\n/**\n * `hostBinding` takes a `hostPropertyName` to attach a data property, a class, a style or an attribute (as `@HostBinding` would) to the host.\n * The udpate is applied based on the update of the provided signal (writable or not).\n *\n * @param {Required<HostBinding>['hostPropertyName']} hostPropertyName - the same property that is bound to a data property, a class, a style or an attribute as `@HostBinding`.\n * @param {Signal | WritableSignal} signal - the signal on which to react to changes to update the host, and the one that will be returned as it is\n * @returns {Signal | WritableSignal}\n *\n * @example\n * ```ts\n * export class MyComponent {\n *  readonly background = hostBinding('style.background', signal('blue'));\n *\n *  constructor() {\n *    setTimeout(() => this.background.set('red'), 3000);\n *  }\n * }\n * ```\n */\nexport function hostBinding<T, S extends Signal<T> | WritableSignal<T>>(\n\thostPropertyName: Required<HostBinding>['hostPropertyName'],\n\tsignal: S,\n\tinjector?: Injector,\n): S {\n\tinjector = assertInjector(hostBinding, injector);\n\n\trunInInjectionContext(injector, () => {\n\t\tconst renderer = inject(Renderer2);\n\t\tconst element: HTMLElement = inject(ElementRef).nativeElement;\n\n\t\teffect(() => {\n\t\t\tlet prevClasses: string[] = [];\n\t\t\tconst value = signal();\n\t\t\tconst [binding, property, unit] = hostPropertyName.split('.');\n\n\t\t\tswitch (binding) {\n\t\t\t\tcase 'style':\n\t\t\t\t\trenderer.setStyle(\n\t\t\t\t\t\telement,\n\t\t\t\t\t\tproperty,\n\t\t\t\t\t\t`${value}${unit ?? ''}`,\n\t\t\t\t\t\tproperty.startsWith('--')\n\t\t\t\t\t\t\t? RendererStyleFlags2.DashCase\n\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'attr':\n\t\t\t\t\tif (value == null) {\n\t\t\t\t\t\trenderer.removeAttribute(element, property);\n\t\t\t\t\t} else {\n\t\t\t\t\t\trenderer.setAttribute(element, property, String(value));\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'class':\n\t\t\t\t\tif (!property) {\n\t\t\t\t\t\tif (prevClasses.length) {\n\t\t\t\t\t\t\tprevClasses.forEach((k) => renderer.removeClass(element, k));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tprevClasses =\n\t\t\t\t\t\t\ttypeof value === 'string' ? value.split(' ').filter(Boolean) : [];\n\t\t\t\t\t\tprevClasses.forEach((k) => renderer.addClass(element, k));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (value) {\n\t\t\t\t\t\t\trenderer.addClass(element, property);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trenderer.removeClass(element, property);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\trenderer.setProperty(element, binding, value);\n\t\t\t}\n\t\t});\n\t});\n\n\treturn signal;\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":";;;AAAA;AAeA;;;;;;;;;;;;;;;;;;AAkBG;SACa,WAAW,CAC1B,gBAA2D,EAC3D,MAAS,EACT,QAAmB,EAAA;AAEnB,IAAA,QAAQ,GAAG,cAAc,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;AAEjD,IAAA,qBAAqB,CAAC,QAAQ,EAAE,MAAK;AACpC,QAAA,MAAM,QAAQ,GAAG,MAAM,CAAC,SAAS,CAAC,CAAC;QACnC,MAAM,OAAO,GAAgB,MAAM,CAAC,UAAU,CAAC,CAAC,aAAa,CAAC;QAE9D,MAAM,CAAC,MAAK;YACX,IAAI,WAAW,GAAa,EAAE,CAAC;AAC/B,YAAA,MAAM,KAAK,GAAG,MAAM,EAAE,CAAC;AACvB,YAAA,MAAM,CAAC,OAAO,EAAE,QAAQ,EAAE,IAAI,CAAC,GAAG,gBAAgB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAE9D,QAAQ,OAAO;AACd,gBAAA,KAAK,OAAO;oBACX,QAAQ,CAAC,QAAQ,CAChB,OAAO,EACP,QAAQ,EACR,GAAG,KAAK,CAAA,EAAG,IAAI,IAAI,EAAE,EAAE,EACvB,QAAQ,CAAC,UAAU,CAAC,IAAI,CAAC;0BACtB,mBAAmB,CAAC,QAAQ;0BAC5B,SAAS,CACZ,CAAC;oBACF,MAAM;AACP,gBAAA,KAAK,MAAM;AACV,oBAAA,IAAI,KAAK,IAAI,IAAI,EAAE;AAClB,wBAAA,QAAQ,CAAC,eAAe,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;qBAC5C;yBAAM;AACN,wBAAA,QAAQ,CAAC,YAAY,CAAC,OAAO,EAAE,QAAQ,EAAE,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;qBACxD;oBACD,MAAM;AACP,gBAAA,KAAK,OAAO;oBACX,IAAI,CAAC,QAAQ,EAAE;AACd,wBAAA,IAAI,WAAW,CAAC,MAAM,EAAE;AACvB,4BAAA,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,QAAQ,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC,CAAC;yBAC7D;wBACD,WAAW;4BACV,OAAO,KAAK,KAAK,QAAQ,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC;AACnE,wBAAA,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,QAAQ,CAAC,QAAQ,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC,CAAC;qBAC1D;yBAAM;wBACN,IAAI,KAAK,EAAE;AACV,4BAAA,QAAQ,CAAC,QAAQ,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;yBACrC;6BAAM;AACN,4BAAA,QAAQ,CAAC,WAAW,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;yBACxC;qBACD;oBACD,MAAM;AACP,gBAAA;oBACC,QAAQ,CAAC,WAAW,CAAC,OAAO,EAAE,OAAO,EAAE,KAAK,CAAC,CAAC;aAC/C;AACF,SAAC,CAAC,CAAC;AACJ,KAAC,CAAC,CAAC;AAEH,IAAA,OAAO,MAAM,CAAC;AACf;;AC3FA;;AAEG;;;;"}